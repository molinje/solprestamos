<mvc:View
  controllerName="prestamos.ccb.org.solprestamos.controller.View2"
  xmlns:mvc="sap.ui.core.mvc"
  xmlns:core="sap.ui.core"
  xmlns:layout="sap.ui.layout"
  xmlns:form="sap.ui.layout.form"
  displayBlock="true"
  xmlns="sap.m">
  <Page
    id="page2"
    title="Prestamo Calamidad"
    showNavButton="true"
    navButtonPress=".onNavBack">
    <content>
      <Wizard id="wizardCalam" complete="onWizardComplete" class="sapUiResponsiveMargin">
                
                <!-- Paso 1: Datos del Préstamo -->
                <WizardStep
                    id="step1"
                    title="Datos del Préstamo"
                    validated="false"
                    activate="onStep1Activate">
                    <VBox class="sapUiSmallMargin">
                    	<form:SimpleForm
										editable="true"
										layout="ResponsiveGridLayout">
                     <Label text="Monto máximo a solicitar" labelFor="MaxValor" />
                        <Input
                            id="MaxValor"
                            value="{
                                parts: [
                                    {path: 'calamView>/montoMaximo'},
                                    {path: 'calamView>/moneda'}
                                ],
                                type: 'sap.ui.model.type.Currency',
                                formatOptions: {
                                    showMeasure: true,
                                    currencyCode: true,
                                    maxFractionDigits: 0
                                }
                            }"
                            editable="false"
                            width="100%"
                            textAlign="End"
                            />
                        <Label text="Cuotas *" labelFor="selectCuotas" class="sapUiSmallMarginBottom" required="true"/>
                        <Select
                            id="selectCuotas"
                            width="100%"
                            selectedKey="{calamView>/selectedCuotas}"
                            change="onCuotasChange"
                            items="{/CuotasCollection}"
                            valueState="{calamView>/cuotasValueState}"
                            valueStateText="{calamView>/cuotasValueStateText}">
                            <core:Item key="{CuotasId}" text="{Name}"/>
                        </Select>
                        
                        <Label text="Valor solicitado" labelFor="inputValor" class="sapUiSmallMarginTop" required="true" />
                        <Input
                             id="inputValor"
                            value="{
                                parts: [
                                    {path: 'calamView>/valorSolicitado'},
                                    {path: 'calamView>/moneda'}
                                ],
                                type: 'sap.ui.model.type.Currency',
                                formatOptions: {
                                    showMeasure: true,
                                    currencyCode: true,
                                    maxFractionDigits: 0
                                }
                            }"
                            change="onValorSolicitadoChange"
                            width="100%"
                            textAlign="End"
                            valueState="{calamView>/valorValueState}"
                            valueStateText="{calamView>/valorValueStateText}"
                            placeholder="Ingrese el valor del préstamo"/>
                         <Label text="Valor prestamo" labelFor="ValorPrestamo" class="sapUiSmallMarginTop" />
                        <Input
                             id="ValorPrestamo"
                            value="{
                                parts: [
                                    {path: 'calamView>/valorPrestamo'},
                                    {path: 'calamView>/moneda'}
                                ],
                                type: 'sap.ui.model.type.Currency',
                                formatOptions: {
                                    showMeasure: true,
                                    currencyCode: true,
                                    maxFractionDigits: 0
                                }
                            }"
                            editable="false"
                            width="100%"
                            textAlign="End"
                            />
                         <Label text="Valor cuota prestamo" labelFor="ValorCuotaP"  class="sapUiSmallMarginTop"/>
                        <Input
                           id="ValorCuotaP"
                            value="{
                                parts: [
                                    {path: 'calamView>/valorCuota'},
                                    {path: 'calamView>/moneda'}
                                ],
                                type: 'sap.ui.model.type.Currency',
                                formatOptions: {
                                    showMeasure: true,
                                    currencyCode: true,
                                    maxFractionDigits: 0
                                }
                            }"
                            editable="false"
                            width="100%"
                            textAlign="End"
                            />
                        <Label text="Motivo Calamidad *" labelFor="selectMotCalamidad" class="sapUiSmallMarginTop" required="true"/>     
                        <Select
					      id="selectMotCalamidad"
					        forceSelection="false"
					        selectedKey="{calamView>/selectedMotCalamidad}"
					        change="onMotivoCalamidadChange"
					        valueState="{calamView>/motivoValueState}"
                            valueStateText="{calamView>/motivoValueStateText}"
					        items="{
						            path: 'pcalamidad>/gt_motcalamidad',
                                    sorter: { path: 'DDTEXT' } 
                                    }">
					        <core:Item key="{pcalamidad>DOMVALUE_L}" text="{pcalamidad>DDTEXT}" />
				        </Select>              
                      </form:SimpleForm>
                        <!-- Botón de Siguiente (reemplaza el botón por defecto del Wizard) -->
                      <Button
                          text="Siguiente"
                          type="Emphasized"
                          icon="sap-icon://navigation-right-arrow"
                          iconFirst="false"
                          press="onValidateStep1"
                          class="sapUiSmallMarginTop"/>
                    </VBox>
                </WizardStep>
                
                <!-- Paso 2: Información del Solicitante -->
                <WizardStep
                    id="step2"
                    title="Datos codeudor"
                    validated="true">
                    <VBox class="sapUiSmallMargin">
                        <form:SimpleForm
										editable="true"
										layout="ResponsiveGridLayout">
                        <Label text="¿Codeudor es trabajador de la CCB?" class="sapUiSmallMarginBottom"/>
                        <RadioButtonGroup
                            id="rbGroupCodeudor"
                            selectedIndex="{calamView>/tieneCodeudor}"
                            select="onCodeudorTypeSelect">
                            <RadioButton text="Sí"/>
                            <RadioButton text="No"/>
                        </RadioButtonGroup>

                        <Label text="Identificación" labelFor="inputIdentificacion"  visible="{calamView>/mostrarCCB}"/>
                        <Input id="inputIdentificacion" 
                               showValueHelp="true" 
                               valueHelpRequest="onIdentificacionValueHelp"
                               placeholder="Presione el icono para buscar colaborador"
                               visible="{calamView>/mostrarCCB}">
                        </Input>

                        

                        <Label text="Nombre" labelFor="CodeudorNombre" visible="{calamView>/mostrarCCB}" />
                        <Input
                            id="CodeudorNombre"
                            value="{calamView>/nombreCodeudor}"
                            editable="true"
                            width="100%"
                            visible="{calamView>/mostrarCCB}" />

                          <Label text="Núm. de empleado" labelFor="CodeudorNumEmpleado" visible="{calamView>/mostrarCCB}" />
                        <Input
                            id="CodeudorumEmpleado"
                            value="{calamView>/numeroEmpleadoCodeudor}"
                            editable="true"
                            width="100%"
                            visible="{calamView>/mostrarCCB}" />
                            <Label text="Cédula" labelFor="CodeudorCedula" visible="{calamView>/mostrarCCB}" />
                        <Input
                            id="CodeudorCedula"
                            value="{calamView>/cedulaCodeudor}"
                            editable="true"
                            width="100%"
                            visible="{calamView>/mostrarCCB}" />


                              <Label text="Nombre" labelFor="CodeudorNombreEx" visible="{calamView>/mostrarExterno}" />
                        <Input
                            id="CodeudorNombreEx"
                            value="{calamView>/nombreCodeudor}"
                            editable="true"
                            width="100%"
                            visible="{calamView>/mostrarExterno}" />

                              <Label text="Cédula" labelFor="CodeudorCedulaEx" visible="{calamView>/mostrarExterno}" />
                        <Input
                            id="CodeudorCedulaEx"
                            value="{calamView>/cedulaCodeudor}"
                            editable="true"
                            width="100%"
                            visible="{calamView>/mostrarExterno}" />

                            <Label text="Dirección" labelFor="CodeudorDireccionEx" visible="{calamView>/mostrarExterno}" />
                        <Input
                            id="CodeudorDireccionEx"
                            value="{calamView>/direccionCodeudor}"
                            editable="true"
                            width="100%"
                            visible="{calamView>/mostrarExterno}" />
                        <Label text="Teléfono" labelFor="CodeudorTelefonoEx" visible="{calamView>/mostrarExterno}" />
                        <Input
                            id="CodeudorTelefonoEx"
                            value="{calamView>/telefonoCodeudor}"
                            editable="true"
                            width="100%"
                            visible="{calamView>/mostrarExterno}" />
                        </form:SimpleForm>
                        	
                    </VBox>
                </WizardStep>
                
                <!-- Paso 3: Compromisos -->
                <WizardStep
                    id="step3"
                    title="Primas y bonificaciones"
                    validated="true">
                    <VBox class="sapUiSmallMargin">
                       <form:SimpleForm
										editable="true"
										layout="ResponsiveGridLayout">
                        <Label text="Fecha" labelFor="datePicker" class="sapUiSmallMarginBottom"/>
                        <DatePicker
                            id="datePicker"
                            value="{calamView>/fecha}"
                            width="100%"
                            placeholder="Seleccione una fecha"/>
                        
                        <Label text="Valor Comprometido" labelFor="inputValorComp" />
                        <Input
                            id="inputValorComp"
                            value="{calamView>/valorComprometido}"
                            type="Number"
                            width="100%"
                            placeholder="Ingrese el valor comprometido"/>
                            </form:SimpleForm>
                    </VBox>
                </WizardStep>
                
                <!-- Paso 4: Documentos -->
                <WizardStep
                    id="step4"
                    title="Soportes"
                    validated="true">
                    <VBox class="sapUiSmallMargin">
                        <Label text="Adjuntar Documentos" class="sapUiSmallMarginBottom"/>
                        <UploadCollection
                            id="uploadCollection"
                            uploadUrl="/upload"
                            multiple="true"
                            uploadComplete="onUploadComplete">
                        </UploadCollection>
                        
                        <Button
                            id="btnCrearSolicitud"
                            text="Crear Solicitud"
                            type="Emphasized"
                            press="onCrearSolicitud"
                            enabled="{calamView>/solicitudEnabled}"
                            class="sapUiMediumMarginTop"
                            width="200px"/>
                    </VBox>
                </WizardStep>
                
      </Wizard>
      <VBox
        alignItems="Center"
        justifyContent="Center"
        class="sapUiMediumMarginTop">
        <items>
  
          <Button
            text="Volver al Inicio"
            type="Emphasized"
            icon="sap-icon://home"
            press=".onNavBack"
            class="sapUiSmallMarginTop"/>
        </items>
      </VBox>
    </content>
  </Page>
</mvc:View>